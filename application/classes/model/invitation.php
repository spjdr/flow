<?php defined('SYSPATH') or die('No direct script access.');class Model_Invitation extends ORM {  	protected $_belongs_to = array( 		'flow' => array('model' => 'flow'), 		'sender' => array('model'=>'user','foreign_key' => 'sender_id') 	); 	 	protected $_rules = array( 		'flow_id' => array( 			'not_empty' => NULL, 		), 		'sender_id' => array( 			'not_empty' => NULL, 		), 		'secret' => array( 			'not_empty' => NULL, 		), 		'email' => array( 			'not_empty' => NULL, 			'email' => NULL, 		), 		'text' => array( 		) 	); 		public function validate_create(& $array) 	{		// Initialise the validation library and setup some rules				$array = Validate::factory($array)						->rules('secret', $this->_rules['secret'])						->rules('flow_id', $this->_rules['flow_id'])						->rules('sender_id', $this->_rules['sender_id'])						->rules('email', $this->_rules['email'])						->filter('secret', 'trim')						->filter('email', 'trim')						->filter('text', 'trim');				return $array;	}		public function save()	{		if (!parent::__isset('created_timestamp')) {			parent::__set('created_timestamp',time());		}				if (!parent::__isset('secret')) {			parent::__set('secret',uniqid());		}			parent::save();	}}