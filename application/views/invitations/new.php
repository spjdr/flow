<?php echo form::open(NULL, array('id' => 'add_invitations')) ?><h1><?php echo __('Add invitations') ?></h1><h4><?php echo form::label('invitations',__('Invitations')) ?></h4><? if (isset($errors['invitations'])) echo $errors['invitations']; ?><div id="invitations">	<div class="invitation">		<?php echo form::input('invitations[1]','',array('id'=>'invitation1')) ?>	</div>	<?php echo form::button('add_invitation','Add email',array('type'=>'button','id'=>'add_invitation')) ?>	<?php echo form::button('remove_invitation','Remove email',array('type'=>'button','id'=>'remove_invitation','disabled'=>'disabled')) ?></div><h4><?php echo form::label('text',__('Text')) ?></h4><? if (isset($errors['text'])) echo $errors['text']; ?><?php echo form::textarea('text',isset($post) ? $post['text'] : '') ?><br/><?php echo form::button(NULL, __('Send'), array('type' => 'submit')) ?><?php echo form::close() ?><!-- Following script modified from http://charlie.griefer.com/blog/index.cfm/2009/9/17/jQuery-Dynamically-Adding-Form-Elements --><script type="text/javascript">$(document).ready(function() {	$('#remove_invitation').click(function(){		var num = new Number($('#invitations div').length);		if (num > 1) {			$('#invitation' + num).parent('div').remove();			if (num == 2) {				$('#remove_invitation').attr('disabled','disabled');			}		} 	});	$('#add_invitation').click(function() {		var num		= $('#invitations div').length;	// how many "duplicatable" input fields we currently have		var new_num	= new Number(num + 1);		// the numeric ID of the new input field being added		// create the new element via clone(), and manipulate it's ID using newNum value		var elem = $('#invitation' + num).parent('div').clone();		// manipulate the name/id values of the input inside the new element		elem.children(':first').attr('id', 'invitation' + new_num).attr('name', 'invitations[' + new_num + ']').attr('value','');			// insert the new element after the last "duplicatable" input field		$('#invitation' + num).parent('div').after(elem);		// enable the "remove" button		$('#remove_invitation').attr('disabled','');	});});</script>